<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"     "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- MyBatis 사용 시 SQL을 관리하는 파일 -->
<mapper namespace="notice">

	<select id="getContent" parameterType="String" resultType="String">
		SELECT business FROM company WHERE seq = #{seq}
	</select>
	
	<select id="getTestType" resultType="com.test.spring.dto.TestTypeDTO">
		SELECT * FROM testType
	</select>
	
	<select id="getHireType" resultType="com.test.spring.dto.HireTypeDTO">
		SELECT * FROM hireType
	</select>
	
	<select id="getCareerType" resultType="com.test.spring.dto.CareerTypeDTO">
		SELECT * FROM careerType
	</select>
	
	<select id="getAreaType" resultType="com.test.spring.dto.AreaTypeDTO">
		SELECT * FROM tblAreaType
	</select>
	
	<select id="getEducationType" resultType="com.test.spring.dto.EducationTypeDTO">
		SELECT * FROM EducationType ORDER BY EducationType
	</select>
	
	<select id="getCertificateType" resultType="com.test.spring.dto.CertificateTypeDTO">
		SELECT * FROM CertificateType ORDER BY certificateType
	</select>
	
	<select id="getLangTestType" resultType="com.test.spring.dto.LangTestTypeDTO">
		SELECT * FROM LangTestType ORDER BY langTestType
	</select>
	
	<select id="getMajorCategory" resultType="com.test.spring.dto.MajorCategoryDTO">
		SELECT * FROM MajorCategory ORDER BY majorCategory
	</select>
	
	<insert id="addNotice" parameterType = "com.test.spring.dto.NoticeDTO">
		INSERT INTO tblNotice 
			(SEQ, COMPANYSEQ, CONTENT, startDate, ENDDATE, REPORT) 
				VALUES 
					(tblnoticeSeq.nextval, #{companySeq}, #{content}, to_date(#{startDate}, 'yyyy-mm-dd HH24:MI'), to_date(#{endDate}, 'yyyy-mm-dd HH24:MI'), #{report})
	</insert>
	
	<select id="getMaxNoticeSeq" resultType = "String">
		SELECT MAX(seq) FROM tblNotice
	</select>
	
	<insert id="addTestByNotice" parameterType = "com.test.spring.dto.TestByNoticeDTO">
		INSERT INTO TESTBYNOTICE 
			(SEQ, NOTICESEQ, TESTTYPESEQ) 
				VALUES 
					(TESTBYNOTICESEQ.nextval, #{noticeSeq}, #{testTypeSeq})
	</insert>
	
	<insert id="addField" parameterType = "com.test.spring.dto.FieldDTO">
		INSERT INTO TBLFIELD 
			(SEQ, NOTICESEQ, FIELDNAME, HIRETYPESEQ, AREATYPESEQ, CONTENT, SALARY, CAREERTYPESEQ) VALUES
				(tblFieldSeq.nextval, #{noticeSeq}, #{fieldName}, #{hireTypeSeq}, #{areaTypeSeq}, #{content}, #{salary}, #{careerTypeSeq})
	</insert>
	
	<select id="getMaxFieldSeq" resultType = "String">
		SELECT MAX(seq) FROM tblField
	</select>
	
	<insert id="addDemandEducation" parameterType = "com.test.spring.dto.DemandEducationDTO">
		INSERT INTO DEMANDEDUCATION (SEQ, FIELDSEQ, EDUCATIONTYPESEQ, ESSENTIAL) VALUES (demandEducationSeq.nextval, #{fieldSeq}, #{educationTypeSeq}, #{essential})
	</insert>
	
	<insert id="addDemandCertificate" parameterType = "com.test.spring.dto.DemandCertificateDTO">
		INSERT INTO DEMANDCERTIFICATE
			(SEQ, FIELDSEQ, ESSENTIAL, CERTIFICATETYPESEQ) 
				VALUES
					(DEMANDCERTIFICATESEQ.nextval, #{fieldSeq}, #{essential}, #{certificateTypeSeq})
	</insert>
	
	<insert id="addDemandLangTest" parameterType = "com.test.spring.dto.DemandLangTestDTO">
		INSERT INTO demandLangTest 
			(SEQ, FIELDSEQ, LANGTESTTYPESEQ, ESSENTIAL) 
				VALUES 
					(demandLangTestSeq.nextval, #{fieldSeq}, #{langTestTypeSeq}, #{essential}) 
	</insert>
	
	<insert id = "addDemandMajor" parameterType = "com.test.spring.dto.DemandMajorDTO">
		INSERT INTO demandMajor 
			(SEQ, FIELDSEQ, MAJORCATEGORYSEQ, ESSENTIAL) 
				VALUES (demandMajorSeq.nextval, #{fieldSeq}, #{majorCategorySeq}, #{essential})
	</insert>
	
	<select id="getList" parameterType="map" resultType="com.test.spring.dto.NoticeDTO">
		SELECT * FROM
		(SELECT a.*, rownum AS rnum FROM
			(SELECT n.SEQ,
				c.name AS companyName,
				c.ADDRESS AS companyAddress,
				n.ENDDATE
					FROM tblNotice n
				INNER JOIN company c
					ON n.COMPANYSEQ = c.SEQ
						WHERE n.CONFIRM = 'y') a)
				WHERE rnum >= #{start} AND rnum <= #{end}
	</select> 
</mapper>















    
    